<div class="container mt-5">
    <div class="card shadow">
        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
            <h4 class="mb-0">Listado de Productos</h4>
            <div class="d-flex align-items-center gap-2">
                <button class="btn btn-success btn-sm" (click)="onCreateProduct()">
                    <i class="bi bi-plus-circle"></i> Crear Producto
                </button>
                <button class="btn btn-danger btn-sm" (click)="onCloseSession()">
                    <i class="bi bi-box-arrow-right"></i> Cerrar Sesión
                </button>
            </div>
        </div>

        <div class="card-body">
            <table mat-table [dataSource]="products" class="mat-elevation-z8" *ngIf="products.length > 0">

                <!-- ID Column -->
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef> ID </th>
                    <td mat-cell *matCellDef="let product"> {{ product.id }} </td>
                </ng-container>

                <!-- Nombre Column -->
                <ng-container matColumnDef="nombre">
                    <th mat-header-cell *matHeaderCellDef> Nombre </th>
                    <td mat-cell *matCellDef="let product"> {{ product.nombre }} </td>
                </ng-container>

                <!-- Stock Column -->
                <ng-container matColumnDef="stock">
                    <th mat-header-cell *matHeaderCellDef> Stock </th>
                    <td mat-cell *matCellDef="let product"> {{ product.stock }} </td>
                </ng-container>

                <!-- Precio Column -->
                <ng-container matColumnDef="precio">
                    <th mat-header-cell *matHeaderCellDef> Precio </th>
                    <td mat-cell *matCellDef="let product"> {{ product.precio | currency }} </td>
                </ng-container>

                <!-- Fecha de Creación Column -->
                <ng-container matColumnDef="fechaCreacion">
                    <th mat-header-cell *matHeaderCellDef> Fecha de Creación </th>
                    <td mat-cell *matCellDef="let product"> {{ product.fechaCreacion | date:'short' }} </td>
                </ng-container>

                <!-- Acciones Column -->
                <ng-container matColumnDef="acciones">
                    <th mat-header-cell *matHeaderCellDef> Acciones </th>
                    <td mat-cell *matCellDef="let product">

                        <button class="btn btn-warning btn-sm me-2" (click)="onEdit(product)"
                            [disabled]="loadingProductId === product.id">Editar</button>

                        <button class="btn btn-danger btn-sm" (click)="onDelete(product)"
                            [disabled]="loadingProductId === product.id">
                            <output *ngIf="loadingProductId === product.id" class="spinner-border spinner-border-sm"
                                aria-hidden="true"></output>
                            Eliminar
                        </button>
                        
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>

            <p *ngIf="products.length === 0" class="text-center mt-3">No hay productos registrados.</p>
        </div>
    </div>
</div>

